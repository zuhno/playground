import { Application, Router, send } from "https://deno.land/x/oak/mod.ts";
import { oakCors } from "https://deno.land/x/cors/mod.ts";

const router = new Router();
router.get("/", async (context) => {
  context.response.body =
    '<MPD xmlns="urn:mpeg:dash:schema:mpd:2011" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:mpeg:dash:schema:mpd:2011 DASH-MPD.xsd" profiles="urn:mpeg:dash:profile:isoff-on-demand:2011" minBufferTime="PT2S" type="static" mediaPresentationDuration="PT15.71845817565918S"><Period id="0" duration="PT15.71845817565918S"><AdaptationSet id="0" contentType="video" frameRate="15360/512" subsegmentAlignment="true" par="9:16" FBUnifiedUploadResolutionMos="360:77.3"><Representation id="879536717508727v" bandwidth="949917" codecs="vp09.00.31.08.00.01.01.01.00" mimeType="video/mp4" sar="1:1" FBEncodingTag="dash_vp9eve_1_v1" FBPlaybackResolutionMos="0:100,360:85.8,480:82.8,720:79.9,1080:77.1" FBPlaybackResolutionMosConfidenceLevel="high" FBPlaybackResolutionCsvqm="0:100,360:97.5,480:96.9,720:95.1,1080:90.6" width="720" height="1280" FBQualityClass="hd" FBQualityLabel="720p"><BaseURL>https://scontent.cdninstagram.com/v/t66.30100-16/323590030_867430748458622_442055958204322600_n.mp4?_nc_cat=103&amp;ccb=1-7&amp;_nc_sid=9a5d50&amp;efg=eyJ2ZW5jb2RlX3RhZyI6ImlnLXhwdmRzLmNsaXBzLmMyLUMzLmRhc2hfdnA5ZXZlXzFfdjEifQ%3D%3D&amp;_nc_ohc=YrSkMxVUiq8AX8-nfV6&amp;_nc_ht=scontent.cdninstagram.com&amp;oh=00_AfCkDP2244AnCSrQAxE6WYrEcBT31aGzGldTJ132--UpOA&amp;oe=65C301FB</BaseURL><SegmentBase indexRange="792-871" timescale="15360" FBFirstSegmentRange="872-532204" FBFirstSegmentDuration="5000" FBSecondSegmentRange="532205-1156477" FBPrefetchSegmentRange="872-532204" FBPrefetchSegmentDuration="5000"><Initialization range="0-791"/></SegmentBase></Representation><Representation id="1019784585960342v" bandwidth="627075" codecs="vp09.00.31.08.00.01.01.01.00" mimeType="video/mp4" sar="1:1" FBEncodingTag="dash_vp9eve_2_v1" FBPlaybackResolutionMos="0:100,360:79.2,480:76,720:73.8,1080:71.9" FBPlaybackResolutionMosConfidenceLevel="high" FBPlaybackResolutionCsvqm="0:100,360:96.4,480:95.3,720:92.4,1080:86.5" width="720" height="1280" FBQualityClass="hd" FBQualityLabel="640p"><BaseURL>https://scontent.cdninstagram.com/v/t66.30100-16/333948937_673426298106268_5942345204688572780_n.mp4?_nc_cat=111&amp;ccb=1-7&amp;_nc_sid=9a5d50&amp;efg=eyJ2ZW5jb2RlX3RhZyI6ImlnLXhwdmRzLmNsaXBzLmMyLUMzLmRhc2hfdnA5ZXZlXzJfdjEifQ%3D%3D&amp;_nc_ohc=kgPZAix2LGcAX9GvUkc&amp;_nc_ht=scontent.cdninstagram.com&amp;oh=00_AfDC-eGd4uSZsU4SghebjjjJjAvNsMyuwj1ptr_a_bZl3Q&amp;oe=65C30603</BaseURL><SegmentBase indexRange="792-871" timescale="15360" FBFirstSegmentRange="872-349345" FBFirstSegmentDuration="5000" FBSecondSegmentRange="349346-755474" FBPrefetchSegmentRange="872-349345" FBPrefetchSegmentDuration="5000"><Initialization range="0-791"/></SegmentBase></Representation><Representation id="203452836145245v" bandwidth="383801" codecs="vp09.00.31.08.00.01.01.01.00" mimeType="video/mp4" sar="1:1" FBEncodingTag="dash_vp9eve_3_v1" FBPlaybackResolutionMos="0:100,360:69.4,480:65.9,720:63.6,1080:62.7" FBPlaybackResolutionMosConfidenceLevel="high" FBPlaybackResolutionCsvqm="0:100,360:93.9,480:91.7,720:86.9,1080:79.4" width="720" height="1280" FBQualityClass="hd" FBQualityLabel="540p"><BaseURL>https://scontent.cdninstagram.com/v/t66.30100-16/46419984_1530518884378844_3448567959870263620_n.mp4?_nc_cat=101&amp;ccb=1-7&amp;_nc_sid=9a5d50&amp;efg=eyJ2ZW5jb2RlX3RhZyI6ImlnLXhwdmRzLmNsaXBzLmMyLUMzLmRhc2hfdnA5ZXZlXzNfdjEifQ%3D%3D&amp;_nc_ohc=l8zjrY2p-z8AX-swo2m&amp;_nc_ht=scontent.cdninstagram.com&amp;oh=00_AfBRf8tmL-f8vQ8kFzt406vX0hCwvvXmsaImndq_s9n3AA&amp;oe=65C274BF</BaseURL><SegmentBase indexRange="792-871" timescale="15360" FBFirstSegmentRange="872-207500" FBFirstSegmentDuration="5000" FBSecondSegmentRange="207501-450836" FBPrefetchSegmentRange="872-207500" FBPrefetchSegmentDuration="5000"><Initialization range="0-791"/></SegmentBase></Representation><Representation id="385450537159184v" bandwidth="222606" codecs="vp09.00.31.08.00.01.01.01.00" mimeType="video/mp4" sar="1:1" FBEncodingTag="dash_vp9eve_4_v1" FBPlaybackResolutionMos="0:100,360:55.5,480:52.2,720:50.7,1080:51.6" FBPlaybackResolutionMosConfidenceLevel="high" FBPlaybackResolutionCsvqm="0:100,360:88.3,480:84.4,720:76.9,1080:67.7" width="670" height="1192" FBQualityClass="sd" FBQualityLabel="480p"><BaseURL>https://scontent.cdninstagram.com/v/t66.30100-16/332581887_806106261190897_5579053344892101258_n.mp4?_nc_cat=105&amp;ccb=1-7&amp;_nc_sid=9a5d50&amp;efg=eyJ2ZW5jb2RlX3RhZyI6ImlnLXhwdmRzLmNsaXBzLmMyLUMzLmRhc2hfdnA5ZXZlXzRfdjEifQ%3D%3D&amp;_nc_ohc=u15FnS4QIQMAX957eW8&amp;_nc_ht=scontent.cdninstagram.com&amp;oh=00_AfC01AN7qpXbS8bLmvWqJDsCDRo8DeR0Z4Y46t8yKRQO3g&amp;oe=65C411C4</BaseURL><SegmentBase indexRange="792-871" timescale="15360" FBFirstSegmentRange="872-121026" FBFirstSegmentDuration="5000" FBSecondSegmentRange="121027-257332" FBPrefetchSegmentRange="872-121026" FBPrefetchSegmentDuration="5000"><Initialization range="0-791"/></SegmentBase></Representation><Representation id="1721377635050560v" bandwidth="129050" codecs="vp09.00.30.08.00.01.01.01.00" mimeType="video/mp4" sar="1:1" FBEncodingTag="dash_vp9eve_5_v1" FBPlaybackResolutionMos="0:100,360:42.6,480:39.9,720:39.5,1080:41.5" FBPlaybackResolutionMosConfidenceLevel="high" FBPlaybackResolutionCsvqm="0:100,360:81.8,480:75.8,720:65.3,1080:54.4" width="442" height="786" FBQualityClass="sd" FBQualityLabel="360p"><BaseURL>https://scontent.cdninstagram.com/v/t66.30100-16/334200341_325869650386533_1780388415292190639_n.mp4?_nc_cat=100&amp;ccb=1-7&amp;_nc_sid=9a5d50&amp;efg=eyJ2ZW5jb2RlX3RhZyI6ImlnLXhwdmRzLmNsaXBzLmMyLUMzLmRhc2hfdnA5ZXZlXzVfdjEifQ%3D%3D&amp;_nc_ohc=uXTUvXlFBcYAX8TuQQH&amp;_nc_ht=scontent.cdninstagram.com&amp;oh=00_AfA54TWLyteYaDhiJ8ymODIwXL3HJhm4p6G6D423HTUaoQ&amp;oe=65C33B56</BaseURL><SegmentBase indexRange="792-871" timescale="15360" FBFirstSegmentRange="872-71011" FBFirstSegmentDuration="5000" FBSecondSegmentRange="71012-149114" FBPrefetchSegmentRange="872-71011" FBPrefetchSegmentDuration="5000"><Initialization range="0-791"/></SegmentBase></Representation><Representation id="1737300496682954vd" bandwidth="1495418" codecs="vp09.00.40.08.00.01.01.01.00" mimeType="video/mp4" sar="1:1" FBEncodingTag="dash_vp9eve_1080p_v1" FBPlaybackResolutionMos="0:100,360:90.3,480:87.9,720:85.6,1080:84.4" FBPlaybackResolutionMosConfidenceLevel="high" FBPlaybackResolutionCsvqm="0:100,360:97.8,480:97.5,720:96.5,1080:94.9" width="1080" height="1920" FBDefaultQuality="1" FBQualityClass="hd" FBQualityLabel="1080p"><BaseURL>https://scontent.cdninstagram.com/v/t66.30100-16/49486691_1518197938999779_5851105520285995312_n.mp4?_nc_cat=111&amp;ccb=1-7&amp;_nc_sid=9a5d50&amp;efg=eyJ2ZW5jb2RlX3RhZyI6ImlnLXhwdmRzLmNsaXBzLmMyLUMzLmRhc2hfdnA5ZXZlXzEwODBwX3YxIn0%3D&amp;_nc_ohc=BhjbLVaaqQ4AX84e1nc&amp;_nc_ht=scontent.cdninstagram.com&amp;oh=00_AfAehiIzuOZL3mP5d7pC9N5gSiXojO0GsPR8Xgyy5ozkkw&amp;oe=65C33178</BaseURL><SegmentBase indexRange="792-871" timescale="15360" FBFirstSegmentRange="872-831337" FBFirstSegmentDuration="5000" FBSecondSegmentRange="831338-1808570" FBPrefetchSegmentRange="872-831337" FBPrefetchSegmentDuration="5000"><Initialization range="0-791"/></SegmentBase></Representation></AdaptationSet><AdaptationSet id="1" contentType="audio" subsegmentAlignment="true"><Representation id="331713459607459ad" bandwidth="80509" codecs="mp4a.40.5" mimeType="audio/mp4" audioSamplingRate="44100" FBEncodingTag="dash_ln_audio_v1" FBDefaultQuality="1"><AudioChannelConfiguration schemeIdUri="urn:mpeg:dash:23003:3:audio_channel_configuration:2011" value="2"/><BaseURL>https://scontent.cdninstagram.com/v/t66.30100-16/316639118_1545822006214137_6309694758948845096_n.mp4?_nc_cat=102&amp;ccb=1-7&amp;_nc_sid=9a5d50&amp;efg=eyJ2ZW5jb2RlX3RhZyI6ImlnLXhwdmRzLmNsaXBzLmMyLUMzLmRhc2hfbG5fYXVkaW9fdjEifQ%3D%3D&amp;_nc_ohc=IQOmKiHvj0cAX9AUJoc&amp;_nc_ht=scontent.cdninstagram.com&amp;oh=00_AfAVcxOoACyia5POEUTfwpkbMT3fwVXaXBqIagMTjlCFaA&amp;oe=65C23D21</BaseURL><SegmentBase indexRange="817-944" timescale="44100" FBFirstSegmentRange="945-21288" FBFirstSegmentDuration="2021" FBSecondSegmentRange="21289-41215" FBPrefetchSegmentRange="945-21288" FBPrefetchSegmentDuration="2021"><Initialization range="0-816"/></SegmentBase></Representation></AdaptationSet></Period></MPD>';
});

const app = new Application();
app.use(oakCors()); // Enable CORS for All Routes
app.use(router.routes());

console.info("CORS-enabled web server listening on port 8080");
await app.listen({ port: 8080 });
